<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Royal Broker ‚Äî Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css"/>
  <style>
    .senha-regras {
      margin-top: 10px;
      font-size: 12px;
    }
    .senha-regra {
      margin: 2px 0;
      transition: color 0.3s;
    }
    .senha-regra.valida {
      color: #39d98a;
    }
    .senha-regra.invalida {
      color: #ff6b6b;
    }
  </style>
</head>
<body class="portal">
  <div class="container portal-container">

    <!-- BOAS-VINDAS + INVESTIMENTOS -->
    <section class="panel panel-royal-outline welcome">
      <div class="welcome-left">
        <!-- LOGO MENOR -->
        <img src="img/royal-logo.png" class="royal-mark" alt="Royal Broker">
        <div class="connected-chip"><span class="online-dot"></span> Conectado</div>

        <h1 class="welcome-title">Bem-vindo, <span id="username"></span>!</h1>
        <p class="welcome-sub">Sua mesa Royal est√° pronta: mercado ao vivo, boleta √°gil e relat√≥rios.</p>
        <div class="last-login muted" id="lastLogin"></div>

        <!-- BOT√ïES IGUAIS (üìà e ‚â°) -->
        <div class="quick-actions">
          <button class="btn-dark-mode" onclick="toggleDarkMode()" id="darkModeBtn">
            <span id="darkModeIcon">üåô</span>
          </button>
          <button class="qa-btn" title="An√°lise t√©cnica" onclick="navegarPara('analise.html')">üìà</button>

          <div class="menu-wrap">
            <button class="qa-btn" id="menuBtn" aria-label="Abrir menu">‚â°</button>
            <div class="menu-dropdown" id="menuDropdown" aria-hidden="true">
                          <button onclick="abrirMinhaConta()">Minha conta</button>
            <button onclick="abrirAlterarSenha()">Alterar senha</button>
            <button class="danger" onclick="logout()">Encerrar sess√£o</button>
            </div>
          </div>
        </div>
      </div>

      <!-- CARD: INVESTIMENTO NACIONAL -->
      <div class="invest-card">
        <div class="invest-head">
          <div class="dot-ok"></div>
          <div class="invest-title">Investimento Nacional</div>
        </div>

        <div class="invest-body">
          <div class="invest-total">
            <div class="invest-label">Total investido + Conta investimento</div>
            <div class="invest-valor">R$ <span id="investTotal">142.360,43</span></div>
            <div class="invest-perf">
              <span id="investPerf" class="up">‚ñ≤ 8,12%</span>
            </div>
            <div class="invest-periodo">
              <small>12 meses</small>
            </div>
          </div>
          <canvas id="invSpark" width="240" height="76"></canvas>
        </div>

        <div class="invest-footer center">
          <div class="invest-saldo">Saldo Conta Investimento Nacional</div>
          <div class="invest-saldo-valor">R$ <span id="saldo">100.000,00</span></div>
        </div>
      </div>
    </section>

    <!-- MERCADO AO VIVO -->
    <section class="panel panel-royal-outline">
      <h3 class="panel-title sparkle">Mercado ao vivo</h3>
      <div class="boleta-row">
        <label>Ativo:
          <select id="rtSymbol" class="rb-input input-royal-focus"></select>
        </label>
        <span class="muted">Pre√ßo atual: R$ <strong id="rtPrice">0,00</strong></span>
      </div>
      <canvas id="rtCanvas" width="900" height="260" class="rt-canvas"></canvas>
    </section>

    <div class="grid-2-col">
      <!-- CARTEIRA COM FAVORITOS -->
      <section class="panel panel-royal-outline">
        <div class="panel-flex">
          <h3 class="panel-title sparkle">Carteira</h3>

          <div class="carteira-controls">
            <button class="btn-turq small" onclick="mostrarFavoritos()" id="btnFavoritosCarteira">
              <span id="favoritosIconCarteira">‚≠ê</span> Meus Favoritos
            </button>
            <div class="export-bar dropdown">
              <button class="btn-json small" onclick="abrirBaixar('carteira')">Baixar Extrato</button>
              <div class="drop" id="drop-carteira" aria-hidden="true">
                <div class="drop-title">Baixar Extrato<br><small>Escolha o formato:</small></div>
                <div class="drop-actions">
                  <button class="btn-xls" onclick="exportarXLS('carteira')">XLSX</button>
                  <button class="btn-json" onclick="exportarJSON('carteira')">JSON</button>
                  <button class="btn-pdf" onclick="exportarPDF('carteira')">PDF</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- SE√á√ÉO DE FAVORITOS -->
        <div id="favoritosSection" class="favoritos-section" style="display: none;">
          <h4 class="favoritos-title">‚≠ê Meus Ativos Favoritos</h4>
          <div id="favoritosList" class="favoritos-grid"></div>
        </div>

        <table id="carteira" class="rb-table">
          <thead>
          <tr>
            <th>Logo</th><th>Ativo</th><th>Quantidade</th>
            <th>Pre√ßo M√©dio (R$)</th><th>Valor Total (R$)</th>
            <th>Lucro/Preju√≠zo</th><th>Varia√ß√£o (%)</th>
          </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <!-- BOOK DE OFERTAS SIMPLIFICADO -->
      <section class="panel panel-royal-outline">
        <h3 class="panel-title center">Book de Ofertas</h3>

        <div class="scrollable">
          <table id="book" class="rb-table with-hover">
            <thead><tr><th>Favorito</th><th>Logo</th><th>Ativo</th><th>Pre√ßo Atual (R$)</th><th>Varia√ß√£o</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="muted tip">Clique na estrela para favoritar. Ao clicar nos ativos, os dados s√£o preenchidos automaticamente na Boleta.</div>
      </section>
    </div>

    <!-- BOLETA MELHORADA -->
    <section class="panel panel-royal-outline">
      <h3 class="panel-title sparkle">Boleta de Compra e Venda</h3>
      <div class="boleta-container">
        <div class="boleta-row">
          <label>Tipo de Opera√ß√£o
            <select id="tipo" class="rb-input input-royal-focus">
              <option>Compra</option><option>Venda</option>
            </select>
          </label>
          
          <label>Ativo
            <select id="ativo" class="rb-input input-royal-focus" onchange="preencherValorBoleta()" oninput="preencherValorBoleta()"></select>
          </label>
        </div>

        <div class="boleta-row">
          <label>Quantidade (m√∫ltiplos de 100)
            <input
              type="number"
              id="quantidade"
              class="rb-input input-royal-focus"
              placeholder="100, 200, 300..."
              autocomplete="off"
              inputmode="numeric"
              pattern="[0-9]*"
              min="100"
              step="100"
              oninput="validarQuantidadeBoleta(this)"
            />
            <small class="hint" id="quantidadeHint"></small>
          </label>

          <label>Valor por lote (R$)
            <input
              type="number"
              id="valor"
              class="rb-input input-royal-focus"
              placeholder="0,00"
              autocomplete="off"
              inputmode="decimal"
              step="0.01"
              readonly
            />
          </label>
        </div>

        <div class="boleta-actions">
          <button class="btn-royal rb-glow" onclick="executarOperacao()">Enviar Ordem</button>
          <button class="btn-turq ghost" onclick="limparBoleta()">Limpar</button>
        </div>
      </div>
      <div id="mensagem" class="msg-inline"></div>
    </section>

    <script>
      // Valida√ß√£o em tempo real para quantidade da boleta
      function validarQuantidadeBoleta(campo) {
        const quantidade = parseInt(campo.value);
        const hint = document.getElementById('quantidadeHint');
        
        if (!campo.value) {
          hint.textContent = '';
          campo.style.borderColor = '';
          return;
        }
        
        if (isNaN(quantidade) || quantidade <= 0) {
          hint.textContent = '‚úó Quantidade deve ser um n√∫mero maior que zero';
          hint.style.color = '#ff6b6b';
          campo.style.borderColor = '#ff6b6b';
          return;
        }
        
        if (quantidade < 100) {
          hint.textContent = '‚úó Quantidade m√≠nima √© 100 a√ß√µes';
          hint.style.color = '#ff6b6b';
          campo.style.borderColor = '#ff6b6b';
          return;
        }
        
        if (quantidade % 100 !== 0) {
          hint.textContent = '‚úó Quantidade deve ser m√∫ltipla de 100';
          hint.style.color = '#ff6b6b';
          campo.style.borderColor = '#ff6b6b';
          return;
        }
        
        hint.textContent = '‚úì Quantidade v√°lida';
        hint.style.color = '#39d98a';
        campo.style.borderColor = '#39d98a';
      }
      
      // Fun√ß√£o para preencher automaticamente o valor da boleta
      function preencherValorBoleta() {
        const ativo = document.getElementById('ativo').value;
        const campoValor = document.getElementById('valor');
        
        if (ativo && ativosB3[ativo]) {
          campoValor.value = ativosB3[ativo].toFixed(2);
          // For√ßa o campo a ser readonly ap√≥s preenchimento
          campoValor.setAttribute('readonly', true);
        } else {
          campoValor.value = '';
        }
      }
      
      // Fun√ß√£o para for√ßar o preenchimento do valor quando a p√°gina carrega
      function inicializarValorBoleta() {
        const ativo = document.getElementById('ativo');
        if (ativo && ativo.value) {
          preencherValorBoleta();
        }
      }
      
      // Expor a fun√ß√£o globalmente para ser chamada do script.js
      window.preencherValorBoleta = preencherValorBoleta;
      
                // Prote√ß√£o adicional: garantir que o campo valor nunca possa ser editado
          document.addEventListener('DOMContentLoaded', function() {
            const campoValor = document.getElementById('valor');
            if (campoValor) {
              // Previne qualquer tentativa de altera√ß√£o
              campoValor.addEventListener('input', function(e) {
                e.preventDefault();
                return false;
              });
              
              campoValor.addEventListener('keydown', function(e) {
                e.preventDefault();
                return false;
              });
              
              campoValor.addEventListener('paste', function(e) {
                e.preventDefault();
                return false;
              });
              
              // For√ßa readonly mas mant√©m o estilo visual
              campoValor.setAttribute('readonly', true);
              campoValor.style.cursor = 'not-allowed';
              // Remove o fundo branco e mant√©m o estilo original
              campoValor.style.backgroundColor = '';
            }
          });
    </script>

    <!-- EXTRATO -->
    <section class="panel panel-royal-outline" id="sec-extrato">
      <div class="panel-flex">
        <h3 class="panel-title sparkle">Extrato de Opera√ß√µes</h3>

        <div class="export-bar dropdown">
          <button class="btn-json small" onclick="abrirBaixar('extrato')">Baixar Extrato</button>
          <div class="drop" id="drop-extrato" aria-hidden="true">
            <div class="drop-title">Baixar Extrato<br><small>Escolha o formato:</small></div>
                          <div class="drop-actions">
                <button class="btn-xls" onclick="exportarXLS('extrato')">XLSX</button>
                <button class="btn-json" onclick="exportarJSON('extrato')">JSON</button>
                <button class="btn-pdf" onclick="exportarPDF('extrato')">PDF</button>
              </div>
          </div>
        </div>
      </div>

      <!-- Filtros -->
      <div id="filtro-datas" class="boleta-row">
        <label>Data Inicial:
          <input type="date" id="dataInicial" class="rb-input input-royal-focus">
        </label>
        <label>Data Final:
          <input type="date" id="dataFinal" class="rb-input input-royal-focus">
        </label>
        <button class="btn-royal rb-glow" onclick="filtrarExtrato()">Filtrar</button>

        <div id="ordenacao-datas" class="boleta-row">
          <label>Ordenar:</label>
          <select id="ordenacao" class="rb-input input-royal-focus">
            <option value="desc">Mais recentes primeiro</option>
            <option value="asc">Mais antigas primeiro</option>
          </select>
        </div>
      </div>

      <div id="filtroMsg" class="error"></div>

      <table id="extrato" class="rb-table">
        <thead>
          <tr>
            <th>Data</th>
            <th>Tipo</th>
            <th>Ativo</th>
            <th>Qtd</th>
            <th>Pre√ßo</th>
            <th>Valor Total (R$)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- FUNCIONALIDADES ADICIONAIS -->
    <div class="grid-2-col">
      <!-- COMPARADOR DE ATIVOS -->
      <section class="panel panel-royal-outline">
        <h3 class="panel-title sparkle">‚öñÔ∏è Comparador de Ativos</h3>
        <div class="comparador-controls">
          <select id="ativo1" class="rb-input">
            <option value="">Selecione o primeiro ativo</option>
          </select>
          <span class="vs">VS</span>
          <select id="ativo2" class="rb-input">
            <option value="">Selecione o segundo ativo</option>
          </select>
          <button class="btn-royal" onclick="compararAtivos()">Comparar</button>
        </div>
        <div id="comparadorResult" class="comparador-result"></div>
      </section>

      <!-- ALERTAS PERSONALIZADOS -->
      <section class="panel panel-royal-outline">
        <h3 class="panel-title sparkle">üîî Alertas Personalizados</h3>
        <div class="alerta-form">
          <input type="text" id="alertaAtivo" class="rb-input" placeholder="Ex: PETR4">
          <select id="alertaCondicao" class="rb-input">
            <option value="acima">subir acima de</option>
            <option value="abaixo">cair abaixo de</option>
          </select>
          <input type="number" id="alertaPreco" class="rb-input" placeholder="R$ 30,00" step="0.01">
          <button class="btn-royal" onclick="criarAlerta()">Criar Alerta</button>
        </div>
        <div id="alertasList" class="alertas-list"></div>
      </section>
    </div>

    <!-- SISTEMA DE CONQUISTAS -->
    <section class="panel panel-royal-outline">
      <h3 class="panel-title sparkle">üèÖ Suas Conquistas</h3>
      <div id="conquistasList" class="conquistas-grid"></div>
    </section>

    <!-- CALEND√ÅRIO DE EVENTOS -->
    <section class="panel panel-royal-outline">
      <h3 class="panel-title sparkle">üìÖ Calend√°rio de Eventos</h3>
      <div id="calendarioEventos" class="calendario-grid"></div>
    </section>

    <!-- CALCULADORA DE CUSTOS -->
    <section class="panel panel-royal-outline">
      <h3 class="panel-title sparkle">üí∞ Calculadora de Custos</h3>
      <div class="calculadora-form">
        <input type="number" id="valorOrdem" class="rb-input" placeholder="Valor da ordem (R$)" step="0.01">
        <button class="btn-royal" onclick="calcularCustos()">Calcular Custos</button>
      </div>
      <div id="custosResult" class="custos-result"></div>
    </section>

    <!-- RANKING DE USU√ÅRIOS -->
    <section class="panel panel-royal-outline">
      <h3 class="panel-title sparkle">üèÜ Top Traders da Semana</h3>
      <div id="rankingUsuarios" class="ranking-usuarios"></div>
    </section>

    <footer class="footer">
      <div>¬© 2025 Royal Broker ‚Äî Todos os direitos reservados.</div>
      <div>Desenvolvido pela Squad: <strong>Sara</strong>, <strong>Gisele</strong>, <strong>Shyva</strong>, <strong>Marcelo</strong>, <strong>Wagner</strong>, <strong>Rafael</strong>.</div>
    </footer>
  </div>

  <!-- ===== MODAIS ===== -->
  <div id="modalBackdrop" class="modal-backdrop" onclick="closeModal(event)"></div>

  <!-- Minha conta (formul√°rio vertical, edit√°vel) -->
  <div id="modalConta" class="rb-modal" role="dialog" aria-modal="true" aria-labelledby="modalContaTitle">
    <div class="modal-head">
      <h3 id="modalContaTitle">Minha conta</h3>
      <button class="modal-x" onclick="hideModal('modalConta')" aria-label="Fechar">√ó</button>
    </div>

    <div class="modal-body">
      <form class="rb-form lefted single-col" onsubmit="event.preventDefault(); salvarMinhaConta();" autocomplete="on">
        <label>Nome completo
          <div class="field-with-edit">
            <input type="text" id="mcNome" class="rb-input input-royal-focus" placeholder="Seu nome" autocomplete="name" readonly 
                   onkeypress="bloquearCaracteresNome(event)" onpaste="validarColagemNome(event)" ondrop="validarColagemNome(event)">
            <button type="button" class="edit-btn" onclick="editarCampo('mcNome')" title="Editar nome">‚úèÔ∏è</button>
          </div>
          <div id="mcNomeError" class="error" style="display: none;"></div>
        </label>

        <label>E-mail
          <div class="field-with-edit">
            <input type="email" id="mcEmail" class="rb-input input-royal-focus" placeholder="Seu e-mail" autocomplete="email" readonly>
            <button type="button" class="edit-btn" onclick="editarCampo('mcEmail')" title="Editar e-mail">‚úèÔ∏è</button>
          </div>
          <div id="mcEmailError" class="error" style="display: none;"></div>
        </label>

        <label>WhatsApp
          <div class="field-with-edit">
            <input type="text" id="mcZap" class="rb-input input-royal-focus" placeholder="Seu celular (DDD)" autocomplete="tel" inputmode="tel" readonly 
                   onkeypress="bloquearCaracteresTelefone(event)" onpaste="validarColagemTelefone(event)" ondrop="validarColagemTelefone(event)">
            <button type="button" class="edit-btn" onclick="editarCampo('mcZap')" title="Editar WhatsApp">‚úèÔ∏è</button>
          </div>
          <div id="mcZapError" class="error" style="display: none;"></div>
        </label>

        <label>CPF
          <input type="text" id="mcCpf" class="rb-input input-royal-focus" placeholder="Seu CPF" readonly>
        </label>

        <label>Plano
          <input type="text" id="mcPlano" class="rb-input input-royal-focus" readonly>
        </label>

        <button class="btn-royal" type="submit" id="btnSalvarConta" style="display: none;">Salvar Altera√ß√µes</button>
        <div id="contaMsg" class="success"></div>
      </form>
    </div>

    <div class="modal-foot">
      <button class="btn-turq" onclick="hideModal('modalConta')">Fechar</button>
    </div>
  </div>

  <!-- Alterar senha -->
  <div id="modalSenha" class="rb-modal" role="dialog" aria-modal="true" aria-labelledby="modalSenhaTitle">
    <div class="modal-head">
      <h3 id="modalSenhaTitle">Alterar senha</h3>
      <button class="modal-x" onclick="hideModal('modalSenha')" aria-label="Fechar">√ó</button>
    </div>
    <div class="modal-body">
      <form onsubmit="event.preventDefault(); alterarSenha();" class="rb-form lefted single-col">
        <label>Nova senha
          <input type="password" id="novaSenhaModal" class="rb-input input-royal-focus" placeholder="m√≠n. 8 caracteres" required oninput="validarCampoSenhaModal(this)">
          <div class="senha-regras" id="senhaRegrasModal">
            <div class="senha-regra invalida" id="regraTamanhoModal">‚Ä¢ M√≠nimo 8 e m√°ximo 12 caracteres</div>
            <div class="senha-regra invalida" id="regraMinusculaModal">‚Ä¢ Pelo menos 1 letra min√∫scula</div>
            <div class="senha-regra invalida" id="regraMaiusculaModal">‚Ä¢ Pelo menos 1 letra mai√∫scula</div>
            <div class="senha-regra invalida" id="regraNumeroModal">‚Ä¢ Pelo menos 1 n√∫mero</div>
            <div class="senha-regra invalida" id="regraEspecialModal">‚Ä¢ Pelo menos 1 caractere especial (!@#$%^&*)</div>
          </div>
        </label>
        <label>Confirmar senha
          <input type="password" id="confSenhaModal" class="rb-input input-royal-focus" placeholder="repita a senha" required oninput="validarConfirmacaoSenhaModal(this)">
          <small class="hint" id="confSenhaHintModal"></small>
        </label>
        <div class="hint">N√£o √© permitido reutilizar nenhuma das <strong>√∫ltimas 4 senhas</strong>.</div>
        <button class="btn-royal rb-enter" type="submit">Salvar nova senha</button>
        <div id="senhaMsgModal" class="error" role="alert"></div>
      </form>
    </div>
  </div>

  <script src="script.js"></script>
  <script>
    // ========= FUN√á√ïES DE BLOQUEIO PARA MINHA CONTA =========
    
    // Fun√ß√£o para bloquear caracteres inv√°lidos no campo nome
    function bloquearCaracteresNome(event) {
      const charCode = event.which ? event.which : event.keyCode;
      
      // Bloqueia n√∫meros (0-9)
      if (charCode >= 48 && charCode <= 57) {
        event.preventDefault();
        return false;
      }
      
      // Bloqueia caracteres especiais (exceto espa√ßo e acentos)
      if (charCode >= 33 && charCode <= 47) { // !"#$%&'()*+,-./
        event.preventDefault();
        return false;
      }
      
      if (charCode >= 58 && charCode <= 64) { // :;<=>?@
        event.preventDefault();
        return false;
      }
      
      if (charCode >= 91 && charCode <= 96) { // [\]^_`
        event.preventDefault();
        return false;
      }
      
      if (charCode >= 123 && charCode <= 126) { // {|}~
        event.preventDefault();
        return false;
      }
      
      // Permite apenas letras (a-z, A-Z), espa√ßos (32) e acentos
      return true;
    }
    
    // Fun√ß√£o para validar colagem no campo nome
    function validarColagemNome(event) {
      event.preventDefault();
      
      let texto = '';
      if (event.type === 'paste') {
        texto = (event.clipboardData || window.clipboardData).getData('text');
      } else if (event.type === 'drop') {
        texto = event.dataTransfer.getData('text');
      }
      
      // Remove n√∫meros e caracteres especiais, mantendo apenas letras, espa√ßos e acentos
      const textoLimpo = texto.replace(/[0-9!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/g, '');
      
      // Aplica o texto limpo
      setTimeout(() => {
        const campo = event.target;
        campo.value = textoLimpo;
        validarCampoMinhaConta('mcNome', textoLimpo);
      }, 10);
      
      return false;
    }
    
    // Fun√ß√£o para bloquear caracteres inv√°lidos no campo telefone
    function bloquearCaracteresTelefone(event) {
      const charCode = event.which ? event.which : event.keyCode;
      
      // Permite apenas n√∫meros (0-9), backspace, delete, tab, enter, setas
      if (charCode === 8 || charCode === 9 || charCode === 13 || 
          charCode === 37 || charCode === 38 || charCode === 39 || charCode === 40) {
        return true;
      }
      
      // Bloqueia tudo que n√£o for n√∫mero
      if (charCode < 48 || charCode > 57) {
        event.preventDefault();
        return false;
      }
      
      return true;
    }
    
    // Fun√ß√£o para validar colagem no campo telefone
    function validarColagemTelefone(event) {
      event.preventDefault();
      
      let texto = '';
      if (event.type === 'paste') {
        texto = (event.clipboardData || window.clipboardData).getData('text');
      } else if (event.type === 'drop') {
        texto = event.dataTransfer.getData('text');
      }
      
      // Remove tudo que n√£o for n√∫mero
      const textoLimpo = texto.replace(/\D/g, '');
      
      // Limita a 11 d√≠gitos
      const textoLimitado = textoLimpo.substring(0, 11);
      
      // Aplica o texto limpo
      setTimeout(() => {
        const campo = event.target;
        campo.value = textoLimitado;
        validarCampoMinhaConta('mcZap', textoLimitado);
      }, 10);
      
      return false;
    }
    
    // Valida√ß√£o em tempo real para senha no modal
    function validarCampoSenhaModal(campo) {
      const senha = campo.value;
      const validacao = validarSenha(senha);
      
      // Atualiza as regras visuais
      document.getElementById('regraTamanhoModal').className = `senha-regra ${validacao.regras.tamanho ? 'valida' : 'invalida'}`;
      document.getElementById('regraMinusculaModal').className = `senha-regra ${validacao.regras.minuscula ? 'valida' : 'invalida'}`;
      document.getElementById('regraMaiusculaModal').className = `senha-regra ${validacao.regras.maiuscula ? 'valida' : 'invalida'}`;
      document.getElementById('regraNumeroModal').className = `senha-regra ${validacao.regras.numero ? 'valida' : 'invalida'}`;
      document.getElementById('regraEspecialModal').className = `senha-regra ${validacao.regras.especial ? 'valida' : 'invalida'}`;
      
      // Atualiza a cor da borda do campo
      if (validacao.valido) {
        campo.style.borderColor = '#39d98a';
      } else {
        campo.style.borderColor = '#ff6b6b';
      }
      
      // Valida confirma√ß√£o de senha se houver
      validarConfirmacaoSenhaModal(document.getElementById('confSenhaModal'));
    }
    
    // Valida√ß√£o de confirma√ß√£o de senha no modal
    function validarConfirmacaoSenhaModal(campo) {
      const senha = document.getElementById('novaSenhaModal').value;
      const confSenha = campo.value;
      const hint = document.getElementById('confSenhaHintModal');
      
      if (!confSenha) {
        hint.textContent = '';
        return;
      }
      
      if (senha === confSenha) {
        hint.textContent = '‚úì Senhas coincidem';
        hint.style.color = '#39d98a';
        campo.style.borderColor = '#39d98a';
      } else {
        hint.textContent = '‚úó As senhas n√£o coincidem';
        hint.style.color = '#ff6b6b';
        campo.style.borderColor = '#ff6b6b';
      }
    }
  </script>
</body>
</html>